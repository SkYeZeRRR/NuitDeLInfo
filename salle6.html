<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eco-Challenge üå≥ : Testez votre Impact Carbone</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">

        <style>
             /* --- CSS : DESIGN PROFESSIONNEL (Palette Bleue/Rigueur) --- */
         :root {
             --primary-color: #3498db; /* Bleu Professionnel dominant */
             --secondary-color: #2c3e50; /* Bleu marine/Noir pour l'accent */
             --bg-color: #f4f6f9;      /* Fond gris clair */
             --card-color: #ffffff;    /* Blanc pour les conteneurs */
             --text-color: #34495e;
             --success-color: #2ecc71; /* Vert pour le succ√®s */
             --error-color: #e74c3c;   /* Rouge pour les erreurs/timer */
         }

        body {
            font-family: 'Montserrat', sans-serif;
            background-color: var(--bg-color);
            background-image: linear-gradient(135deg, #f4f6f9 0%, #d5dbde 100%);
            color: var(--text-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        .container {
            background: var(--card-color);
            padding: 3rem;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
            width: 95%;
            max-width: 700px;
            text-align: center;
            position: relative;
            transition: transform 0.3s;
        }

        .screen {
            display: none;
            animation: fadeIn 0.7s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .screen.active {
            display: block;
        }

        h1, h2 {
            color: var(--secondary-color);
            font-weight: 700;
        }

        /* Boutons */
        .btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 14px 35px;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: 50px;
            cursor: pointer;
            transition: background 0.3s, transform 0.2s;
            margin: 10px 5px;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.4);
        }

        .btn:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background-color: var(--secondary-color);
            box-shadow: 0 4px 15px rgba(44, 62, 80, 0.4);
        }

        .btn-secondary:hover {
            background-color: #34495e;
        }

        /* Quiz Header */
        .header-quiz {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 10px;
        }

        .timer-box, .progress-box {
            font-weight: 700;
            padding: 5px 15px;
            border-radius: 10px;
            background: #fcfcfc;
            font-size: 0.9rem;
            border: 1px solid #ddd;
        }

        .timer-box.critical {
            color: var(--error-color);
            animation: pulse 1s infinite;
        }

        .question-text {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 30px;
        }

        .options-grid {
            display: grid;
            gap: 15px;
            margin-top: 20px;
        }

        .option-btn {
            background-color: #f8f9fa;
            border: 1px solid #dfe6e9;
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.2s;
            text-align: left;
        }

        .option-btn:hover:not(:disabled) {
            background-color: #ebf5fb;
            border-color: var(--primary-color);
            transform: translateX(5px);
        }

        /* Vrai/Faux Feedback */
        .option-btn.correct {
            background-color: var(--success-color);
            color: white;
            border-color: var(--success-color);
        }

        .option-btn.wrong {
            background-color: var(--error-color);
            color: white;
            border-color: var(--error-color);
        }

        /* Section R√©sultat */
        .score-display {
            font-size: 4rem;
            font-weight: 700;
            color: var(--primary-color);
            margin: 20px 0 10px;
        }

        .time-details {
            display: flex;
            justify-content: space-around;
            margin: 20px 0 30px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .time-detail strong {
            display: block;
            font-size: 1.8rem;
            color: var(--secondary-color);
        }

        .feedback {
            font-size: 1.2rem;
            margin: 20px 0;
            padding: 25px;
            border-radius: 15px;
            border-left: 5px solid var(--primary-color);
            background: #eaf5fb; /* Bleu tr√®s p√¢le */
        }

        /* Modal de Correction */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background: var(--card-color);
            padding: 40px;
            border-radius: 15px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 10px 50px rgba(0,0,0,0.5);
        }

        .review-item {
            margin-bottom: 25px;
            padding: 15px;
            border-radius: 10px;
            text-align: left;
            border: 1px solid #ddd;
        }

        .review-item h4 {
            margin-top: 0;
            font-size: 1.1rem;
        }

        .review-item.correct-answer {
            background: #f0fff0;
            border-left: 5px solid var(--success-color);
        }

        .review-item.wrong-answer {
            background: #fff0f0;
            border-left: 5px solid var(--error-color);
        }

        .explanation-box {
            font-style: italic;
            font-size: 0.95rem;
            color: #555;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px dashed #ccc;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(231, 76, 60, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(231, 76, 60, 0); }
            100% { box-shadow: 0 0 0 0 rgba(231, 76, 60, 0); }
        }

        /* Media Query pour mobile */
        @media (max-width: 600px) {
            .container { padding: 20px; }
            .options-grid { grid-template-columns: 1fr; }
            .header-quiz { flex-direction: column; gap: 10px; }
            .time-details { flex-direction: column; }
            .time-detail { margin-bottom: 15px; }
        }
    </style>
</head>
<body>

<div class="container">

    <div id="start-screen" class="screen active">
        <h1>üéØ Quiz N√©gociation</h1>
        <p style="color: var(--primary-color); font-weight: 600; text-transform: uppercase;">La D√©marche NIRN (N√©gociation, Information, Relation, N√©gociation)</p>
        <p>Testez vos connaissances sur les √©tapes cl√©s pour mener une n√©gociation efficace.</p>
        <div style="background: #f9f9f9; padding: 20px; border-radius: 10px; margin: 25px 0; text-align: left; border-left: 4px solid var(--primary-color);">
            üëâ 15 questions sur les √©tapes de Pr√©paration, Information, √âtablissement de la Relation et Conclusion.<br>
            üí° Rapport de correction d√©taill√© √† la fin, incluant le temps mis !
        </div>
        <button onclick="startQuiz()" class="btn">D√©marrer le Quiz NIRN</button>
    </div>

    <div id="quiz-screen" class="screen">
        <div class="header-quiz">
            <div class="timer-box">
                ‚è±Ô∏è <span id="time">15</span> secondes
            </div>
            <div class="progress-box">
                Question <span id="current-question-num">1</span> / 15
            </div>
        </div>

        <div class="question-container">
            <div class="question-text" id="question-text">
                Chargement de la question...
            </div>
            <div id="options-container" class="options-grid">
            </div>
        </div>
    </div>

    <div id="result-screen" class="screen">
        <h2>üèÜ Bilan de Comp√©tences !</h2>
        <p>Votre performance sur la d√©marche NIRN :</p>
        <div class="score-display">
            <span id="final-score">0</span> / 15
        </div>

        <div class="time-details">
            <div class="time-detail">
                <small>Temps Total</small>
                <strong id="total-time-display">0s</strong>
            </div>
            <div class="time-detail">
                <small>Temps Moyen par Question</small>
                <strong id="avg-time-display">0s</strong>
            </div>
        </div>

        <p id="feedback-text" class="feedback"></p>

        <button onclick="showReviewModal()" class="btn btn-secondary">Voir la Correction (Pourquoi ?)</button>
        <button onclick="restartQuiz()" class="btn">Rejouer</button>
    </div>

</div>

<div id="review-modal" class="modal" onclick="closeReviewModal(event)">
    <div class="modal-content" onclick="event.stopPropagation()">
        <h2 style="color: var(--secondary-color);">Rapport de Correction D√©taill√©</h2>
        <p>Analyse de vos r√©ponses et explications des concepts cl√©s de la n√©gociation.</p>
        <div id="review-content">
        </div>
        <button onclick="closeReviewModal()" class="btn" style="margin-top: 20px;">Fermer le Rapport</button>
    </div>
</div>

<script>
    // --- JAVASCRIPT : LOGIQUE AVANC√âE ---

    // 1. La base de donn√©es de questions (Th√®me NIRN)
    const questions = [
        // √âtape N (Pr√©paration / N√©gociation Initiale)
        {
            question: "Quelle est la fonction principale de la BATNA (Best Alternative To a Negotiated Agreement) ?",
            options: ["D√©finir votre objectif de prix id√©al", "√âvaluer le seuil de rupture de la n√©gociation", "Servir de point de d√©part aux concessions", "Identifier les besoins de l'autre partie"],
            answer: 1,
            explanation: "La BATNA d√©termine votre meilleure option en cas d'√©chec des n√©gociations. Elle fixe votre seuil de rupture et votre pouvoir r√©el."
        },
        {
            question: "Que repr√©sente la ZOPA (Zone of Possible Agreement) ?",
            options: ["La zone d'influence g√©ographique des parties", "L'√©cart entre le prix d'ouverture et le prix de fermeture", "La zone de chevauchement des objectifs acceptables", "L'ensemble des sujets abord√©s dans la n√©gociation"],
            answer: 2,
            explanation: "La ZOPA est la zone o√π les objectifs acceptables des deux parties se chevauchent, permettant un accord mutuellement satisfaisant."
        },
        {
            question: "Lors de la pr√©paration, quel type d'objectif est le plus important √† d√©finir ?",
            options: ["L'objectif plancher (le minimum acceptable)", "L'objectif id√©al (le maximum souhait√©)", "L'objectif cr√©dible (le r√©aliste)", "Les trois sont essentiels"],
            answer: 3,
            explanation: "Les trois niveaux d'objectifs (plancher, cr√©dible, id√©al) sont essentiels pour encadrer la n√©gociation et √©viter les regrets ou les ruptures inutiles."
        },

        // √âtape I (Information / √âcoute)
        {
            question: "Dans la phase d'Information, quel est l'objectif principal des questions ouvertes ?",
            options: ["Obtenir une r√©ponse par 'Oui' ou 'Non'", "Contr√¥ler la direction de l'entretien", "Encourager l'autre partie √† s'exprimer librement et √† d√©voiler ses besoins", "Valider un point pr√©cis rapidement"],
            answer: 2,
            explanation: "Les questions ouvertes (commen√ßant par 'Comment', 'Pourquoi', 'Quoi') permettent de d√©couvrir les motivations, les priorit√©s et les contraintes de l'interlocuteur."
        },
        {
            question: "Qu'est-ce que l'√©coute active ?",
            options: ["√âcouter sans interruption", "Reformuler, poser des questions de clarification et valider la compr√©hension", "Se concentrer uniquement sur les chiffres et les faits", "Pr√©parer mentalement sa prochaine r√©plique"],
            answer: 1,
            explanation: "L'√©coute active implique une participation consciente, notamment par la reformulation et la validation, pour s'assurer de la bonne compr√©hension et montrer de l'empathie."
        },
        {
            question: "Comment doit-on g√©rer un silence pendant la phase d'Information ?",
            options: ["Le combler imm√©diatement pour √©viter la g√™ne", "Le consid√©rer comme un signe d'accord", "Le respecter, car il pousse souvent l'autre partie √† donner plus d'information", "L'utiliser pour changer de sujet"],
            answer: 2,
            explanation: "Un silence bien g√©r√© est un outil puissant. Il exerce une pression subtile sur l'interlocuteur, l'incitant souvent √† en dire plus sur ses r√©els besoins ou contraintes."
        },

        // √âtape R (Relation / Rapport)
        {
            question: "Comment √©tablit-on la confiance (phase Relation) rapidement avec l'autre partie ?",
            options: ["En parlant de soi et de ses r√©ussites", "En faisant preuve de transparence et en reconnaissant les points communs", "En faisant une concession majeure d√®s le d√©part", "En √©tant strictement factuel et distant"],
            answer: 1,
            explanation: "La confiance se b√¢tit par l'authenticit√©, la transparence et la d√©couverte de points communs (personnels ou professionnels) qui cr√©ent un climat de collaboration."
        },
        {
            question: "Quel r√¥le joue le langage corporel dans la phase Relation ?",
            options: ["Il est moins important que le discours", "Il repr√©sente environ 5% de la communication", "Il doit √™tre dominant pour affirmer l'autorit√©", "Il transmet plus de 50% du message et r√©v√®le l'√©tat √©motionnel"],
            answer: 3,
            explanation: "Le non-verbal (posture, gestes, micro-expressions) est essentiel dans la cr√©ation de la relation et du climat de confiance."
        },
        {
            question: "Que signifie 'isoler une objection' ?",
            options: ["Ignorer l'objection et passer √† autre chose", "Demander s'il n'y a pas d'autres objections avant de la traiter", "R√©pondre imm√©diatement avec un argument fort", "Dire que l'objection est infond√©e"],
            answer: 1,
            explanation: "Isoler l'objection (en demandant '√Ä part cela, tout le reste vous convient ?') permet de s'assurer qu'il s'agit du seul point de blocage avant d'investir de l'√©nergie pour le r√©soudre."
        },
        {
            question: "Quel comportement est un signe de faible engagement de l'autre partie ?",
            options: ["Poser beaucoup de questions techniques", "H√©siter √† discuter des termes financiers", "√âvoquer souvent sa BATNA", "Exprimer de l'enthousiasme pour le produit"],
            answer: 2,
            explanation: "Si l'interlocuteur h√©site √† parler argent ou ne donne pas acc√®s √† la personne qui prend la d√©cision, cela peut indiquer un faible engagement ou une absence de pouvoir d'achat."
        },

        // √âtape N (Conclusion / N√©gociation Finale)
        {
            question: "Qu'est-ce que la technique d'ancrage dans la phase finale ?",
            options: ["Fixer un lieu de rencontre id√©al", "Proposer une premi√®re offre tr√®s favorable", "Proposer une premi√®re offre volontairement extr√™me pour influencer la perception", "Ne rien proposer et attendre l'offre de l'autre partie"],
            answer: 2,
            explanation: "L'ancrage consiste √† poser une premi√®re offre ambitieuse (mais d√©fendable) qui 'ancre' la n√©gociation autour de ce point de r√©f√©rence, m√™me si l'accord final est loin de cette offre."
        },
        {
            question: "Comment pr√©senter une concession de mani√®re professionnelle ?",
            options: ["La donner discr√®tement sans commentaire", "La faire pr√©c√©der d'un 'Si... alors' (contrepartie)", "La faire passer pour une erreur corrig√©e", "La donner uniquement √† la toute fin"],
            answer: 1,
            explanation: "Toute concession doit √™tre conditionnelle et valoris√©e ('Si je vous accorde cela, qu'√™tes-vous pr√™t √† faire en √©change ?'). Ne jamais donner gratuitement."
        },
        {
            question: "Quel est le risque de faire une concession progressive (petites concessions successives) ?",
            options: ["L'autre partie se sent satisfaite rapidement", "Cela cr√©e un sentiment de p√©nurie", "L'autre partie pense que vous avez une marge illimit√©e", "Cela facilite la relation"],
            answer: 2,
            explanation: "Faire des concessions successives donne l'impression que vous pouvez toujours aller plus loin, affaiblissant ainsi votre position et encourageant l'autre partie √† demander plus."
        },
        {
            question: "Quelle est la meilleure technique de cl√¥ture si l'accord est proche mais h√©sitant ?",
            options: ["Cl√¥ture par ultimatum ('C'est √ßa ou rien')", "Cl√¥ture par l'alternative ('Pr√©f√©rez-vous le forfait A ou B ?')", "Cl√¥ture par le silence", "Cl√¥ture par la menace"],
            answer: 1,
            explanation: "La cl√¥ture par l'alternative suppose que la d√©cision est d√©j√† prise et ne laisse que le choix du d√©tail, facilitant ainsi la finalisation."
        }
    ];

    // 2. Variables d'√©tat √©tendues
    let currentQuestionIndex = 0;
    let score = 0;
    let timer;
    let timeLeft = 15;
    const timePerQuestion = 15;
    let quizStartTime;
    let quizEndTime;
    let userAnswers = [];

    // 3. S√©lection des √©l√©ments HTML (Mise √† jour pour les nouveaux √©l√©ments)
    const startScreen = document.getElementById("start-screen");
    const quizScreen = document.getElementById("quiz-screen");
    const resultScreen = document.getElementById("result-screen");
    const questionText = document.getElementById("question-text");
    const optionsContainer = document.getElementById("options-container");
    const timeDisplay = document.getElementById("time");
    const finalScore = document.getElementById("final-score");
    const feedbackText = document.getElementById("feedback-text");
    const totalTimeDisplay = document.getElementById("total-time-display");
    const avgTimeDisplay = document.getElementById("avg-time-display");
    const reviewModal = document.getElementById("review-modal");
    const reviewContent = document.getElementById("review-content");

    // 4. Fonctions de gestion du Quiz
    function startQuiz() {
        startScreen.classList.remove("active");
        quizScreen.classList.add("active");
        resultScreen.classList.remove("active");

        currentQuestionIndex = 0;
        score = 0;
        userAnswers = [];
        quizStartTime = new Date().getTime();

        loadQuestion();
    }

    function loadQuestion() {
        clearInterval(timer);
        timeLeft = timePerQuestion;
        timeDisplay.innerText = timeLeft;
        timeDisplay.parentElement.classList.remove('critical');
        startTimer();

        const currentQuestion = questions[currentQuestionIndex];
        questionText.innerText = currentQuestion.question;
        document.getElementById("current-question-num").innerText = currentQuestionIndex + 1;

        optionsContainer.innerHTML = "";

        currentQuestion.options.forEach((option, index) => {
            const button = document.createElement("button");
            button.innerText = option;
            button.classList.add("option-btn");
            button.onclick = () => selectAnswer(index);
            optionsContainer.appendChild(button);
        });
    }

    function startTimer() {
        timer = setInterval(() => {
            timeLeft--;
            timeDisplay.innerText = timeLeft;

            if(timeLeft <= 5) {
                timeDisplay.parentElement.classList.add('critical');
            }

            if (timeLeft <= 0) {
                clearInterval(timer);
                selectAnswer(-1);
            }
        }, 1000);
    }

    function selectAnswer(selectedIndex) {
        clearInterval(timer);
        const currentQuestion = questions[currentQuestionIndex];
        const buttons = optionsContainer.getElementsByClassName("option-btn");
        const timeSpent = timePerQuestion - (timeLeft > 0 ? timeLeft : 0);

        for (let btn of buttons) {
            btn.disabled = true;
            btn.style.opacity = "0.7";
        }
        if (selectedIndex === currentQuestion.answer) {
            buttons[selectedIndex].classList.add("correct");
            buttons[selectedIndex].style.opacity = "1";
            score++;
        } else {
            if (selectedIndex !== -1) {
                buttons[selectedIndex].classList.add("wrong");
            }
            buttons[currentQuestion.answer].classList.add("correct");
            buttons[currentQuestion.answer].style.opacity = "1";
        }

        userAnswers.push({
            question: currentQuestion.question,
            options: currentQuestion.options,
            selected: selectedIndex,
            correct: currentQuestion.answer,
            isCorrect: (selectedIndex === currentQuestion.answer),
            explanation: currentQuestion.explanation,
            timeSpent: timeSpent
        });

        setTimeout(() => {
            currentQuestionIndex++;
            if (currentQuestionIndex < questions.length) {
                loadQuestion();
            } else {
                endQuiz();
            }
        }, 1500);
    }

    function endQuiz() {
        quizScreen.classList.remove("active");
        resultScreen.classList.add("active");
        quizEndTime = new Date().getTime();

        const totalTime = ((quizEndTime - quizStartTime) / 1000).toFixed(1);
        const avgTime = (totalTime / questions.length).toFixed(1);

        finalScore.innerText = score;
        totalTimeDisplay.innerText = totalTime + 's';
        avgTimeDisplay.innerText = avgTime + 's';

        generateFeedback(score);
    }

    function generateFeedback(currentScore) {
        let message = "";
        let color = "";

        if (currentScore === 15) {
            message = "üëë Expert en N√©gociation ! Votre ma√Ætrise de la d√©marche NIRN est parfaite. Vous √™tes pr√™t(e) √† conclure les affaires les plus complexes.";
            color = "#27ae60";
        } else if (currentScore >= 11) {
            message = "‚≠ê Ma√Ætrise Forte ! Vous avez une excellente compr√©hension des fondamentaux (BATNA, ZOPA, Relation). Quelques d√©tails √† perfectionner.";
            color = "#2ecc71";
        } else if (currentScore >= 6) {
            message = "üíº Bases Acquises. Vous connaissez les grandes √©tapes de la NIRN. Concentrez-vous sur les techniques sp√©cifiques (Ancrage, Concessions).";
            color = "#f39c12";
        } else {
            message = "üß≠ Piste de Progr√®s. Il est temps d'approfondir chaque √©tape de la n√©gociation. Le rapport de correction est votre meilleur outil !";
            color = "#e74c3c";
        }

        feedbackText.innerText = message;
        feedbackText.style.borderColor = color;
    }

    // 5. Fonctions du Modal de Correction
    function showReviewModal() {
        reviewModal.style.display = 'flex';
        reviewContent.innerHTML = '';

        userAnswers.forEach((item, index) => {
            const reviewItem = document.createElement("div");
            reviewItem.classList.add("review-item", item.isCorrect ? "correct-answer" : "wrong-answer");

            const result = item.isCorrect ? "‚úÖ Correct" : "‚ùå Incorrect";
            const userChoiceText = item.selected !== -1 ? item.options[item.selected] : "Aucune r√©ponse (Temps √©coul√©)";
            const correctAnswerText = item.options[item.correct];

            // D√©finir la couleur du r√©sultat pour la consistance
            const resultColor = item.isCorrect ? 'var(--success-color)' : 'var(--error-color)';

            reviewItem.innerHTML = `
                    <h4>Question ${index + 1} : ${item.question}</h4>
                    <p>R√©sultat : <span style="color: ${resultColor}; font-weight: 700;">${result}</span> (Temps : ${item.timeSpent}s)</p>
                    <p>Votre choix : ${userChoiceText} ${!item.isCorrect && item.selected !== -1 ? `<span style="color: var(--error-color);">(Faux)</span>` : ''}</p>
                    <p>R√©ponse correcte : ${correctAnswerText}</p>
                    <div class="explanation-box">
                        L'explication (Pourquoi ?) : ${item.explanation}
                    </div>
                `;
            reviewContent.appendChild(reviewItem);
        });
    }

    function closeReviewModal(event) {
        if (event === undefined || event.target.id === 'review-modal') {
            reviewModal.style.display = 'none';
        }
    }

    function restartQuiz() {
        resultScreen.classList.remove("active");
        startScreen.classList.add("active");
        reviewModal.style.display = 'none';
    }
</script>
</body>
</html>
